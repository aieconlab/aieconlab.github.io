{{ define "main" }}

<!-- Author Profile Section -->
<section class="author-section section-sm">
  <div class="container">
    <div class="author-card">
      <!-- Author Header -->
      <div class="author-header">
        <!-- Avatar -->
        <div class="author-avatar">
          {{ if .Params.Image }}
          {{ $img := resources.Get .Params.Image }}
          {{ $img := $img.Fill "300x300 webp Center" }}
          <img loading="lazy" decoding="async"
               class="avatar-img"
               width="{{ $img.Width }}"
               height="{{ $img.Height }}"
               src="{{ $img.RelPermalink }}"
               alt="{{ .Title }}">
          {{ else if .Params.Email }}
          <img loading="lazy" class="avatar-img"
               src="https://www.gravatar.com/avatar/{{ md5 .Params.email }}?s=300&d=identicon"
               alt="{{ .Title }}">
          {{ end }}
        </div>

        <!-- Author Info -->
        <div class="author-info">
          <h1 class="author-name">{{ .Title }}</h1>

          <!-- Social Links -->
          {{ with .Params.social }}
          <div class="author-social">
            {{ range . }}
            <a href="{{ .link | safeURL }}"
               class="social-btn"
               target="_blank"
               rel="noopener noreferrer"
               aria-label="{{ .icon }}">
              <i class="{{ .icon }}"></i>
            </a>
            {{ end }}
          </div>
          {{ end }}
        </div>
      </div>

      <!-- Author Bio -->
      <div class="author-bio content">
        {{ .Content }}
      </div>
    </div>
  </div>
</section>

<!-- Posts by Author Section -->
<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="section-title text-center mb-5">
          <h2>{{ i18n "posted_by" }}</h2>
        </div>
      </div>

      {{ range where site.RegularPages "Params.author" .Title }}
      {{ $post := . }}
      <div class="col-lg-4 col-md-6 mb-4">
        <article class="post-card">
          {{ with .Params.images }}
          <div class="post-card-image">
            {{ range first 1 . }}
            {{ if (fileExists (add `assets/` .)) }}
            {{ $image := resources.Get . }}
            {{ $thumb := $image.Fill "400x250 webp Center" }}
            <a href="{{ $post.RelPermalink }}">
              <img loading="lazy"
                   class="img-fluid"
                   src="{{ $thumb.RelPermalink }}"
                   alt="{{ $post.Title }}">
            </a>
            {{ end }}
            {{ end }}
          </div>
          {{ end }}

          <div class="post-card-content">
            <h3 class="post-card-title">
              <a href="{{ .RelPermalink }}">{{ .Title }}</a>
            </h3>
            <div class="post-card-meta">
              <span><i class="far fa-calendar-alt"></i> {{ .PublishDate.Format "2006.01.02" }}</span>
            </div>
            <p class="post-card-excerpt">{{ .Summary | truncate 80 }}</p>
          </div>
        </article>
      </div>
      {{ end }}
    </div>
  </div>
</section>

{{ end }}
